# Galaxy Number Counts in a Single CCD Field

This repository contains the code used for my Year 3 Astrophysics lab

The analysis includes:

Background measurement and bad–pixel handling  
Saturated–star and halo cleaning
Source detection and basic star/galaxy separation  
Aperture photometry with a 3″ diameter  
Construction and fitting of log N(m) vs. magnitude

The figures and numerical results produced by this code are used in my lab report.


# 1. Data

The analysis assumes the following FITS files are available:

'mosaic.fits' 
  Raw (or pipeline–reduced) CCD mosaic provided as part of the lab.

'mosaic_cleaned_enhanced.fits'  
  Version of the mosaic after saturated–star / halo cleaning.  
  This file can be generated by the halo–removal notebook in this repo.



# 2. Dependencies

The code is written in Python and uses Jupyter notebooks.

Tested with:

Python 3.14.0
numpy
scipy
astropy
matplotlib
photutils (optional; only used in some experimental approaches)



# 3. Repository structure

Main notebooks:

'read_mosaic.ipynb'
Load mosaic.fits, inspect the image, compute background statistics
(median, MAD–based sigma), and visualise the raw field.

'histogram_mosaic.ipynb'
Make histograms of pixel values, fit a Gaussian to the sky distribution,
and verify the global background used for detection thresholds.

'background_saturation_remove.ipynb'
Explore methods to identify saturated regions, bleeding columns, and the
bright–star halo. Implements:
background,
saturation thresholds,
connected–component labelling,
k–nearest–neighbour (kNN) density–based halo removal,
generation of mosaic_cleaned_enhanced.fits.

'aperture photometry.ipynb'
Implements circular aperture photometry with a 3″ diameter:
radius from pixel scale (0.258″/pix),
local sky from an annulus (r_in, r_out),
net flux and basic uncertainty estimate,
tests on bright isolated sources.

'analysis.ipynb'
Main science process:
source detection using a threshold of bg + 5σ, with a minimum area cut,
removing detections in the kNN–defined halo region,
star/galaxy separation using a concentration index and equal–radius size,
conversion of net flux to calibrated magnitude using a zero point,
construction of cumulative counts for all sources, stars, and galaxies.

'results.ipynb'
Final products:
cumulative $\log_{10} N(<m)$ vs. calibrated magnitude for all/stellar/galaxy samples,
Poisson error bars for each bin,
weighted linear fits to the galaxy $\log N$–$m$ relation over a chosen magnitude range,
exploration of how changing the fit range or kNN parameters affects the slope and its uncertainty,
plots use in the report.



# Running the notebooks in the order above should reproduce all the figures and
numerical values quoted in the report.
